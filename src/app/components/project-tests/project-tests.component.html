<div class="container" *ngIf="testResult">
  <div class="section" *ngFor="let responseDto of testResult.responseDto">
    <div class="section-header get-section" (click)="toggleCollapse(responseDto)">
      <div class="section-title">{{ responseDto?.type }}</div>
      <div class="section-content">{{ responseDto?.url }}</div>
      <div class="section-badge-container">
        <span class="section-title badge text-bg-primary">{{
          responseDto?.httpStatus
          }}</span>
        <span [ngClass]="{
            badge: true,
            'text-bg-success': responseDto?.validationStatus === 'VALID',
            'text-bg-danger': responseDto?.validationStatus !== 'VALID'
          }">
          {{ responseDto?.validationStatus }}
        </span>
      </div>
      <div class="section-triangle"></div>
    </div>
    <div class="section-content" [ngClass]="{ collapse: !responseDto.isCollapsed }">
      <div class="section-title">Expected response</div>
      <div class="scrollable-section">
        <pre class="json-code">
          <div class="section-content">{{ responseDto?.expectedResponse }}</div>
        </pre>
      </div>
      <div class="section-title">Actual Response</div>
      <div class="scrollable-section">
        <pre class="json-code">
          <div class="section-content">{{ responseDto?.actualResponse }}</div>
        </pre>
      </div>
      <div *ngIf="responseDto?.validationStatus !== 'VALID'">
        <div class="section-title">Rapport</div>
        <div class="scrollable-section">
          <div class="section-content">
            <div *ngIf="responseDto?.messages">
              <div *ngFor="let message of responseDto?.messages">
                <div class="card">
                  <div class="card-body">
                    <p>Operation :{{ message.op }}</p>
                    <p>Path :{{ message.path }}</p>
                    <p>Value: {{ message.value?.msg ?? "" }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <br>
      <button type="button" class="btn btn-warning"
        (click)="handleUpdateExpectedResponse(responseDto.id,responseDto.actualResponse)">Update Expected
        Response</button>
    </div>
  </div>
</div>